#!/usr/bin/env r

library(ggplot2)
library(RColorBrewer)  # for brewer.pal()

# define grid
x<-seq(1,11,1.0)
y<-seq(1,11,1.0)

xyz.func<-function(x,y) {-10.4+6.53*x+6.53*y-0.167*x^2-0.167*y^2+0.0500*x*y}
gg   <- expand.grid(x=x,y=y)
gg$z <- with(gg,xyz.func(x,y)) # need long format for ggplot


brks <- cut(gg$z,breaks=seq(0,100,len=6))
brks <- gsub(","," - ",brks,fixed=TRUE)
gg$brks <- gsub("\\(|\\]","",brks)  # reformat guide labels
p <- ggplot(gg,aes(x,y)) +
     geom_tile(aes(fill=brks)) +
     scale_fill_manual("Effort",values=brewer.pal(6,"RdYlGn")) +
     scale_x_continuous(expand=c(0,0)) +
     scale_y_continuous(expand=c(0,0)) +
     coord_fixed() +
     labs(x="Buildings") +
     labs(y="Applications") +
     labs(z="Effort")

ggsave('effort.pdf')

