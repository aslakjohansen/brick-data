#!/usr/bin/env r

library(ggplot2)
library(RColorBrewer)  # for brewer.pal()

# define grid
x<-seq(1,10,1.0)
y<-seq(1,10,1.0)

# costs
cost_brick       <- 60
cost_hardcoded   <- 0
cost_application <- 60
cost_building    <- 60
cost_combo       <- 60

#xyz.func<-function(x,y) {(cost_brick+cost_building*x+cost_application*y)/(cost_hardcoded+cost_combo*x*y)}
xyz.func<-function(x,y) {-200+x*100+y*50}
gg   <- expand.grid(x=x,y=y)
gg$z <- with(gg,xyz.func(x,y)) # need long format for ggplot


brks <- cut(gg$z,breaks=seq(0,100,len=6))
brks <- gsub(","," - ",brks,fixed=TRUE)
#gg$brks <- gsub("\\(|\\]","",brks)  # reformat guide labels
p <- ggplot(gg,aes(x,y)) +
     geom_tile(aes(fill=brks)) +
     scale_fill_manual("Effort",values=brewer.pal(6,"RdYlGn")) +
     scale_x_continuous(expand=c(0,0)) +
     scale_y_continuous(expand=c(0,0)) +
     coord_fixed() +
     labs(x="Buildings") +
     labs(y="Applications") +
     labs(z="Effort")

ggsave('effort.pdf')

